<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main}">
<meta charset="utf-8">
<main layout:fragment="common">

    <h2>게시판 조회</h2>
    <form th:action="@{/posts/posts/all}" method="get">
        <select name="bNo">
            <option value="">All Boards</option>
            <option value="1">Board 1</option>
            <option value="2">Board 2</option>
            <!-- Add more options for other boards -->
        </select>
        <button type="submit">Filter by Board</button>
    </form>
    <table class="table text-center">
        <thead>
        <tr>
            <th>게시글 번호</th>
            <th>회원 ID</th>
            <th>별명</th>
            <th>게시판</th>
            <th>제목</th>
            <th>작성일</th>
            <th>수정일</th>
        </tr>
        </thead>

        <!-- 게시판 내용 반복 -->
        <tr th:each="post : ${posts}">
            <td th:text="${post.pNo}"></td>
            <td th:text="${post.member.mId}"></td>
            <td th:text="${post.member.mNickName}"></td>
            <td th:text="${post.board.bName}"></td>
            <td><a th:href="@{'/post/' + ${post.pNo}}" th:text="${post.pTitle}"></a></td>
            <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></td>
            <td th:text="${#temporals.format(post.updatedAt, 'yyyy-MM-dd HH:mm:ss')}"></td>

            <!-- 게시글 삭제 -->
            <td>
                <form th:action="@{'/post/' + ${post.pNo}}" method="post" onsubmit="return confirm('게시글 삭제를 진행하면 모든 내용과 댓글이 영구적으로 사라집니다. 계속 진행하시겠습니까??')">
                    <input type="hidden" name="_method" value="delete"/>
                    <button type="submit">게시글 삭제</button>
                </form>
            </td>

        </tr>
    </table>

    <!-- 게시글 조회 -->
    <form th:action="@{/post/postList/search}" method="get">
        <!-- Search Category -->
        <select name="category">
            <option value="pNo">게시글 번호</option>
            <option value="mId">작성자 ID</option>
            <option value="mNickName">작성자 별명</option>
            <option value="bName">게시판</option>
            <option value="pTitle">제목</option>
        </select>

        <input type="text" name="query" placeholder="검색">

        <button type="submit">검색</button>
        <a th:href="@{/post/postList/all}">전체보기</a>
    </form>

    <div class="pagination">
        <ul>
            <!-- showPrev가 true일 때 '이전' 링크를 보여줍니다 -->
            <li th:if="${pageHandler.showPrev}">
                <a th:href="@{'/post/postList/all?page=' + ${pageHandler.beginPage - 1}}">이전</a>
            </li>

            <!-- 페이지 번호들을 보여줍니다 -->
            <li th:each="pageNum : ${#numbers.sequence(pageHandler.beginPage, pageHandler.endPage)}">
                <a th:href="@{'/admin/post/postList/all?page=' + ${pageNum}}"
                   th:text="${pageNum}"
                   th:class="${pageNum == pageHandler.page ? 'active' : ''}"></a>
            </li>

            <!-- showNext가 true일 때 '다음' 링크를 보여줍니다 -->
            <li th:if="${pageHandler.showNext}">
                <a th:href="@{'/post/postList/all?page=' + ${pageHandler.endPage + 1}}">다음</a>
            </li>
        </ul>
    </div>

</main>
</html>