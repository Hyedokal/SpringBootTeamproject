<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <link th:href="@{../static/css/styles.css}" href="../static/css/styles.css" rel="stylesheet">
  <title>글 상세</title>
  <style>
    input {
      border: none;
    }
  </style>
</head>
  <body>
<div class="board_wrap">
  <div class="board_title">
    <h2 th:text="'글 상세'">글 상세</h2>
  </div>

  <div class="board_view_wrap">
    <div class="board_view">
      <div class="title">
        <label for="boardSubject">제목 : </label>
        <input type="text" id="boardSubject" name="boardSubject" class="form-control" th:value="${post.pTitle}" readonly>
      </div>

      <div class="info">
        <dl>
          <dt><label for="boardId">게시글 번호 : </label></dt>
          <dd><input type="text" id="boardId" name="boardId" class="form-control" th:value="${post.pNo}" readonly></dd>

          <dt><label for="author">작성자 ID : </label></dt>
          <dd><input type="text" id="author" name="author" class="form-control" th:value="${post.member.mId}" readonly></dd>

          <dt><label for="regdate">등록일 : </label></dt>
          <dd><input type="text" id ="regdate" name ="regdate"class ="form-control"
                     th:value="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm:ss')}" readonly ></dd>
        </dl>
        <dl>
          <dt><label for="viewcnt">조회수 : </label></dt>
          <dd><input type="text" id="viewcnt" name="viewcnt" class="form-control" th:value="${post.viewCount}" readonly></dd>
        </dl>
        </div>

      <div class="cont">
        <label for="contents" th:text="#{}"></label>
        <textarea id="contents" name="contents" class="form-control" th:text="${post.pContent}" readonly></textarea>
      </div>

      <hr class="my-4">

      <!-- 댓글 창 시작 -->
      <div class="comment_section">
        <h3>댓글</h3>

        <!-- 댓글 입력 폼 -->
        <form action="/posts/{pNo}/comments" th:action="@{/posts/{pNo}/comments(pNo=${post.pNo})}" method="post">
          <div>
            <label for="commentContent">댓글 작성:</label>
            <textarea id="commentContent" name="cContent" class="form-control" rows="3" required></textarea>
          </div>
          <div class="bt_wrap">
            <button type="submit">댓글 작성</button>
          </div>
        </form>

        <!-- 댓글 목록 표시 -->
        <div class="comment_list">
          <ul>
            <!-- 댓글을 Thymeleaf 반복문을 사용하여 조회 -->
            <li th:each="comment : ${post.comments}">
              <div class="comment_content">
                <!-- Display comment author's nickname -->
                <span class="comment_author" th:text="${comment.member.mNickName}"></span>
                <!-- Display comment creation time -->
                <span class="comment_date" th:text="${#temporals.format(comment.cCreatedAt, 'yyyy-MM-dd HH:mm:ss')}"></span>
                <!-- Display comment content -->
                <p class="comment_text" th:text="${comment.cContent}"></p>
              </div>
            </li>
          </ul>
        </div>
      <!-- 댓글 창 끝 -->

      <hr class="my-4">

      <div class="bt_wrap">
        <!-- 글 목록, 글 수정, 글 삭제 버튼은 이미 있는 코드입니다. -->
        <a href="/posts/all" th:href="@{/posts/all}" th:text="#{}">글 목록</a>
        <a href="/posts/{pNo}/edit" th:href="@{/posts/{pNo}/edit(pNo=${post.pNo})}" th:text="#{}">글 수정</a>
        <form action="/posts/{pNo}/delete" th:action="@{/posts/{pNo}/delete(pNo=${post.pNo})}" method="post"
              onsubmit="return confirm('게시글 삭제를 진행하면 모든 내용과 댓글이 영구적으로 사라집니다. 계속 진행하시겠습니까??')">
          <input type="hidden" name="_method" value="post"/>
          <button type="submit">글 삭제</button>
        </form>
      </div>

      <div class="cont">
        <label for="contents" th:text="#{}"></label>
        <textarea id="contents" name="contents" class="form-control" th:text="${post.pContent}" readonly></textarea>
      </div>

      <hr class="my-4">

      <!-- 댓글 창 시작 -->
      <div class="comment_section">
        <h3>댓글</h3>

        <!-- 댓글 입력 폼 -->
        <form action="/posts/{pNo}/comments" th:action="@{/posts/{pNo}/comments(pNo=${post.pNo})}" method="post">
          <div>
            <label for="commentContent">댓글 작성:</label>
            <textarea id="commentContent" name="cContent" class="form-control" rows="3" required></textarea>
          </div>
          <div class="bt_wrap">
            <button type="submit">댓글 작성</button>
          </div>
        </form>

        <!-- 댓글 목록 표시 -->
        <div class="comment_list">
          <ul>
            <!-- 댓글을 Thymeleaf 반복문을 사용하여 조회 -->
            <li th:each="comment : ${post.comments}">
              <div class="comment_content">
                <!-- Display comment author's nickname -->
                <span class="comment_author" th:text="${comment.member.mNickName}"></span>
                <!-- Display comment creation time -->
                <span class="comment_date" th:text="${#temporals.format(comment.cCreatedAt, 'yyyy-MM-dd HH:mm:ss')}"></span>
                <!-- Display comment content -->
                <p class="comment_text" th:text="${comment.cContent}"></p>
              </div>
            </li>
          </ul>
        </div>
      <!-- 댓글 창 끝 -->

      <hr class="my-4">

      <div class="bt_wrap">
        <!-- 글 목록, 글 수정, 글 삭제 버튼은 이미 있는 코드입니다. -->
        <a href="/posts/all" th:href="@{/posts/all}" th:text="#{}">글 목록</a>
        <a href="/posts/{pNo}/edit" th:href="@{/posts/{pNo}/edit(pNo=${post.pNo})}" th:text="#{}">글 수정</a>
        <form action="/posts/{pNo}/delete" th:action="@{/posts/{pNo}/delete(pNo=${post.pNo})}" method="post"
              onsubmit="return confirm('게시글 삭제를 진행하면 모든 내용과 댓글이 영구적으로 사라집니다. 계속 진행하시겠습니까??')">
          <input type="hidden" name="_method" value="post"/>
          <button type="submit">글 삭제</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- 푸터 -->
<footer class="py-5 bg-dark" th:href="@{../static/css/styles.css.css}" href="../static/css/styles.css"
        rel="stylesheet">
  <div class="container">
    <p class="m-0 text-center text-white">2023 Ait - Betting Site Prj</p>
  </div>
</footer>

<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="js/scripts.js"></script>
</body>
</html>